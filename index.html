<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>AssistSR2</title>
    <!-- Dépendances d'origine conservées -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" crossorigin="anonymous"/>

    <style>
      /* ======== Thème et tokens ======== */
      :root{
        --brand: #3a86ff;
        --brand-2: #8338ec;
        --bg-soft: #f6f8fc;
        --text-muted: #6b7280;
        --radius: 16px;
        --card-bg: #ffffff;
        --card-border: #e7edf3;
        --shadow: 0 16px 42px rgba(16,24,40,.12);
        --shadow-soft: 0 10px 30px rgba(16,24,40,.08);
      }
      @media (prefers-color-scheme: dark){
        :root{
          --bg-soft: #0b1220;
          --text-muted: #9aa5b1;
          --card-bg: #0f172a;
          --card-border: #1e293b;
        }
        body{ color:#e7edf6; }
        .btn-secondary{ color:#e2e8f0; border-color:#334155; }
        .list-group-item{ background: var(--card-bg); color: #e7edf6; }
      }

      /* ======== Fond et conteneur ======== */
      body{
        background:
          radial-gradient(50vw 50vw at 10% -15%, #eaf2ff 0%, rgba(255,255,255,0) 60%),
          radial-gradient(50vw 50vw at 110% 30%, #f1eaff 0%, rgba(255,255,255,0) 60%),
          var(--bg-soft);
        min-height: 100vh;
      }
      .app-wrap{
        max-width: 980px;
        margin: 2rem auto;
        padding: 0 1rem;
      }

      /* ======== Bandeau / Hero ======== */
      .hero{
        background: linear-gradient(135deg, rgba(255,255,255,.92), rgba(255,255,255,.65));
        border: 1px solid var(--card-border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 1.25rem 1.25rem 1rem;
      }
      .hero .brand-chip{
        display:inline-flex; align-items:center; gap:.5rem;
        padding:.35rem .75rem; border-radius:999px; color:#fff; font-weight:600;
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        box-shadow: 0 10px 22px rgba(58,134,255,.25);
      }
      .hero .logo{
        width:72px; height:72px; border-radius:14px; object-fit:cover;
        border:6px solid #fff; box-shadow: var(--shadow-soft);
      }
      .hero .sub{
        color: var(--text-muted); margin: .25rem 0 0;
      }

      /* ======== Carte question ======== */
      #question{
        background: var(--card-bg);
        border: 1px solid var(--card-border);
        border-radius: var(--radius);
        box-shadow: var(--shadow-soft);
        padding: 1.25rem;
        animation: fadeUp .25s ease-out;
      }
      #question > p{
        font-size:1.15rem; font-weight:600; margin-bottom: .75rem;
      }
      @keyframes fadeUp{
        from{ opacity:0; transform: translateY(6px) }
        to{ opacity:1; transform: translateY(0) }
      }

      /* ======== Options (list-group) ======== */
      .option-item{
        border-radius: 12px !important;
        border: 1px solid rgba(16,24,40,.08) !important;
        padding: 14px 16px !important;
        transition: transform .06s ease, box-shadow .12s ease, border-color .12s ease;
        white-space: normal;
      }
      .option-item i{ opacity:.75; }
      .option-item:hover{
        transform: translateY(-1px);
        box-shadow: 0 10px 24px rgba(16,24,40,.12);
        border-color: rgba(16,24,40,.18) !important;
        text-decoration: none;
      }
      .option-item:focus{
        outline: none;
        box-shadow: 0 0 0 .25rem rgba(58,134,255,.25);
      }

      /* ======== Boutons ======== */
      #buttons{
        display:flex; gap:.5rem; flex-wrap:wrap;
      }
      #buttons .btn{
        border-radius: 999px; padding: .5rem .9rem;
        box-shadow: 0 8px 18px rgba(16,24,40,.06);
      }
      .btn-info{
        background-image: linear-gradient(135deg, var(--brand), var(--brand-2));
        border:none;
      }
      .btn-info:hover{ filter: brightness(1.03); }
      .btn-info:focus{ box-shadow: 0 0 0 .25rem rgba(58,134,255,.35); }

      /* ======== Aides de mise en page ======== */
      .section-title{
        font-weight: 700;
        margin: 1.25rem 0 .75rem;
      }
      .helper{
        color: var(--text-muted);
        margin-top:.25rem;
      }
    </style>
  </head>
  <body>
    <div class="app-wrap">
      <!-- Bandeau / Hero (titres conservés) -->
      <div class="hero mb-3">
        <div class="d-flex align-items-center">
          <img src="doggygo.png" alt="" class="logo mr-3"/>
          <div>
            <span class="brand-chip"><i class="fa fa-paw"></i>&nbsp;Doggygo</span>
            <h3 class="mb-0 mt-2">Votre assistant personnalis&eacute;</h3>
            <p class="sub">Vous avez une question et vous voudriez conna&icirc;tre la personne &agrave; contacter au Service de la Recherche ?<br>
              R&eacute;pondez tout simplement aux questions que Doggygo vous posera ci-dessous.</p>
          </div>
        </div>
      </div>

      <h3 class="section-title">Doggygo dit :</h3>

      <!-- Zone dynamique conservée -->
      <div id="question" aria-live="polite" style="margin-bottom: 1rem"></div>

      <!-- Boutons d'origine, IDs conservés -->
      <div id="buttons" style="display:none">
        <a id="back" href="javascript:goback();" class="btn btn-secondary btn-default" style="display:none; text-decoration:none">
          <i class="fa fa-chevron-left"></i>&nbsp;back
        </a>
        <a id="restart" href="javascript:location.reload()" class="btn btn-secondary btn-default" style="display:none; text-decoration:none">
          <i class="fa fa-arrow-circle-o-left"></i>&nbsp;restart
        </a>
      </div>
    </div>

    <!-- Script d'origine conservé (mêmes fonctions / variables) -->
    <script>
      // *** parameters start ***
      // default language
      var lang = "fr";

      var papagoUrl = "./trees/";

      var persons = {
        "EAM" : {
            "name": "Eliane Abou Mansour",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Eliane%20Abou%20Mansour,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=abou&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "VL" : {
            "name": "V\u00e9ronique Longchamp",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=V%C3%A9ronique%20Longchamp,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=longchamp&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "AEDC" : {
            "name": "Anne-Emmanuelle de Crousaz",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Anne-Emmanuelle%20de%20Crousaz,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=emmanuelle&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "AB" : {
            "name": "Aur\u00e9lie Brehmer",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Aur%C3%A9lie%20Brehmer,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=Brehmer&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "CA" : {
            "name": "Claire Arnold",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Claire%20Arnold,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=arnold&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "ZEM" : {
            "name": "Zohra El Masbahi",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Zohra%20El%20Masbahi,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=zohra&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "ACB" : {
            "name": "Anne-Christine Butty",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Anne-Christine%20Butty,ou=D%C3%A9canat%20(FBM),ou=FBM%20-%20D%C3%A9canat,ou=D%C3%A9canat%20%20hors%20d%C3%A9partements%20(FBM),ou=Facult%C3%A9%20de%20biologie%20et%20de%20m%C3%A9decine,o=Universite%20de%20Lausanne,c=ch?query=butty&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "MD" : {
            "name": "Ma\u00eblle Desard",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Ma%C3%ABlle%20Desard,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=desard&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "PAD" : {
            "name": "Pablo Andr\u00e9s Diaz",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Pablo%20Andr%C3%A9s%20Diaz,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=pablo&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "TVL" : {
            "name": "Th\u00e9 Van Luong",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Th%C3%A9%20Van%20Luong,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=luong&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "MC" : {
            "name": "Micaela Crespo",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Rocio%20Micaela%20Crespo%20Quesada,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=crespo&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "LC" : {
            "name": "Lucia Couto",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Lucia%20Couto,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=couto&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"},
        "JR" : {
            "name": "Julian Randall",
            "url": "https://www3.unil.ch/annuaire/browse/person/cn=Julian%20Randall,ou=Service%20de%20la%20recherche,ou=Services%20Centraux,o=Universite%20de%20Lausanne,c=ch?query=julian&base=o%3DUniversite+de+Lausanne%2Cc%3Dch&category=2"}
      };

      var translate = { 
        "fr" : {
            "contact": "Contacter",
            "text" : "La personne mentionn\u00e9e ci-dessous est en mesure de vous offrir son expertise pour vous conseiller sur le sujet qui vous pr\u00e9occupe.",
            "error" : "Doggygo n\'est pas accessible pour le moment."},
        "en" : {
            "contact": "Contact",
            "text" : "The individual below can provide valuable insights and advice you on the subject matter you're interested in.",
            "error" : "Doggygo is not available at the moment."},
      }

      var parent = oldItem = sheet = jList = "";

      function format(item) {
        // on vérifie si les 9 premiers caractères sont égaux à "Contacter"
        if (item.substr(0,9) == "Contacter") {
            parent = oldItem;
            item = item.replace("Contacter", translate[lang]["contact"]);
            var url = item.split(' ');
            
            // *** UI: sortie contact soignée (toujours fidèle au contenu) ***
            var code = ''
              + '<p>' + translate[lang]["text"] + '</p>'
              + '<a class="btn btn-info btn-lg" target="_blank" href="'+ persons[url[1]]["url"] + '">'
              +   '<i class="fa fa-send"></i>&nbsp;' + url[0] + '&nbsp;' + persons[url[1]]["name"]
              + '</a>';

            $('#submit').hide(); 
            $('#restart').show();
        }
        // si ce n'est pas égal à "Contacter", on continue avec les autres questions
        else {
            jList = '';
            $('#restart').hide();

            // *** UI: options modernisées, ajout classe option-item (le reste inchangé) ***
            var code = '<p>' + papago[item]['label'] + '</p>'
              + '<div class="list-group btn-group-vertical" role="group" style="max-width:1000px; width:100%">';
            $.each(papago[item]['options'], function(index,value) {
                code = code
                  + '<a class="list-group-item list-group-item-action btn option-item"'
                  + ' style="text-align:left; text-decoration:none; white-space:normal;"'
                  + ' href="javascript:format(\'' + value['value'] +'\')">'
                  +   '<i class="fa fa-arrow-right"></i>&nbsp;' + value['option']
                  + '</a>';
            });
            code = code + '</div>';

            if (papago[item]['parent']) {
                $('#back').show();
            }
            else {
                $('#back').hide();
            }
            parent = papago[item]['parent'];
            oldItem = item;
        }
        $('#question').html(code);
      }

      function goback() {
        format(parent);
      }

      $(document).ready(function(){
        var param = {};
        var str = window.location.search.substr(1);
        if(str) {
            var pairs = str.split('&');
            for (var i=0; i<pairs.length; i++) {
                var part = pairs[i].split('=');
                param[part[0]] = part[1];
            }
        }
        if(param['lang'] && translate[param['lang']]) {
            lang = param['lang'];
        }
        if(param['notitle'] && param['notitle']=='true') {
            $('h3').hide();
        }

        // petit squelette visuel pendant le chargement (non intrusif)
        $('#question').html(
          '<div class="progress" style="height:6px;"><div class="progress-bar progress-bar-striped progress-bar-animated" style="width: 45%"></div></div>'
        );

        $.getJSON( papagoUrl + "papago-" + lang + ".json")
          .done(function( data ) {
              papago = data;
              $('#buttons').show();
              format("0");
          })
          .fail(function(xhr, status, error) {
              $('#question').html(
                '<div class="alert alert-danger mb-0" role="alert">'
                + '<i class="fa fa-exclamation-triangle"></i> '
                + translate[lang]['error']
                + '</div>'
              );
              console.log( error );
          });
      });
    </script>
  </body>
</html>
